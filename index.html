<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STONK ALERTS 🚀 - TO THE MOON!</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Variables for better maintainability */
        :root {
            --bg-gradient-start: #0a0a0a;
            --bg-gradient-mid: #1a1a2e;
            --bg-gradient-end: #16213e;
            --text-color-primary: #e0e6ed;
            --text-color-secondary: #b8c5d1;
            --accent-color: #00ff88; /* Green for Bulls */
            --accent-color-light: rgba(0, 255, 136, 0.1);
            --accent-color-border: rgba(0, 255, 136, 0.3);
            --bear-color: #ff4444; /* Red for Bears */
            --bear-color-light: rgba(255, 68, 68, 0.1);
            --bear-color-border: rgba(255, 68, 68, 0.3);
            --card-bg: rgba(255, 255, 255, 0.03);
            --card-border: rgba(255, 255, 255, 0.08);
            --header-bg: rgba(0, 0, 0, 0.3);
            --header-border: rgba(255, 255, 255, 0.1);
            --legend-bg: rgba(255, 255, 255, 0.03);
            --legend-border: rgba(255, 255, 255, 0.1);
            --section-bg: rgba(255, 255, 255, 0.02);
            --info-color-blue: #00aaff;
            --info-color-orange: #ffaa00;
            --info-color-purple: #aa44ff;
            --error-color: #ff6b6b;
            --rocket-color: #ff6b00;
            --meme-color: #ff00ff;
            --dd-color: #4169e1;
            --gain-color: #00ff00;
            --loss-color: #ff0000;

            --font-family-mono: 'JetBrains Mono', monospace;
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-mid) 50%, var(--bg-gradient-end) 100%);
            font-family: var(--font-family-mono);
            color: var(--text-color-primary);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.5;
        }

        /* Scrolling ticker */
        .ticker-wrapper {
            background: rgba(0, 0, 0, 0.8);
            border-bottom: 2px solid var(--accent-color);
            overflow: hidden;
            position: relative;
        }

        .ticker {
            display: flex;
            animation: scroll 30s linear infinite;
            padding: 0.5rem 0;
        }

        @keyframes scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .ticker-item {
            padding: 0 2rem;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
            color: var(--accent-color);
        }

        .ticker-item.loss {
            color: var(--loss-color);
        }

        .ticker-item.gain {
            color: var(--gain-color);
        }

        /* Rocket animations */
        @keyframes rocket-launch {
            0% { transform: translateY(0) rotate(-45deg); }
            50% { transform: translateY(-30px) rotate(-45deg); }
            100% { transform: translateY(0) rotate(-45deg); }
        }

        @keyframes pulse-glow {
            0% { box-shadow: 0 0 5px var(--accent-color); }
            50% { box-shadow: 0 0 20px var(--accent-color), 0 0 40px var(--accent-color); }
            100% { box-shadow: 0 0 5px var(--accent-color); }
        }

        .rocket {
            display: inline-block;
            animation: rocket-launch 2s ease-in-out infinite;
        }
        
        .header {
            text-align: center;
            padding: var(--spacing-lg) var(--spacing-md);
            background: var(--header-bg);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--header-border);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            letter-spacing: -0.03em;
            color: #fff;
            text-shadow: 0 0 20px var(--accent-color);
        }

        .header .subtitle {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            color: var(--info-color-orange);
            font-weight: 600;
        }
        
        .header p {
            font-size: 0.7rem;
            opacity: 0.8;
            text-transform: uppercase;
        }

        /* Stats Bar */
        .stats-bar {
            background: rgba(0, 0, 0, 0.5);
            padding: 1rem;
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stat-label {
            font-size: 0.7rem;
            opacity: 0.7;
            text-transform: uppercase;
        }

        .stat-value {
            font-size: 1rem;
            font-weight: 700;
        }

        .stat-value.gain {
            color: var(--gain-color);
        }

        .stat-value.loss {
            color: var(--loss-color);
        }

        /* WSB Special Tags */
        .wsb-tag {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.6rem;
            font-weight: 700;
            text-transform: uppercase;
            margin-left: 0.5rem;
            animation: pulse-glow 2s ease-in-out infinite;
        }

        .wsb-tag.dd {
            background: var(--dd-color);
            color: white;
        }

        .wsb-tag.yolo {
            background: var(--rocket-color);
            color: white;
        }

        .wsb-tag.meme {
            background: var(--meme-color);
            color: white;
        }

        .wsb-tag.gain-porn {
            background: var(--gain-color);
            color: black;
        }

        .wsb-tag.loss-porn {
            background: var(--loss-color);
            color: white;
        }

        /* Meme Mode Toggle */
        .meme-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1001;
            background: var(--meme-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .meme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--meme-color);
        }

        /* Meme Mode Styles */
        body.meme-mode {
            animation: rainbow 5s linear infinite;
        }

        @keyframes rainbow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        body.meme-mode .stock-card {
            animation: wiggle 0.5s ease-in-out infinite;
        }

        @keyframes wiggle {
            0%, 100% { transform: rotate(-1deg); }
            50% { transform: rotate(1deg); }
        }

        /* Emoji Rain */
        .emoji-rain {
            position: fixed;
            top: -50px;
            font-size: 2rem;
            animation: fall 3s linear;
            pointer-events: none;
            z-index: 9999;
        }

        @keyframes fall {
            to {
                transform: translateY(calc(100vh + 50px));
            }
        }
        
        .legend {
            background: var(--legend-bg);
            border: 1px solid var(--legend-border);
            border-radius: 12px;
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
            backdrop-filter: blur(8px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .legend-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: var(--spacing-lg);
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
        }
        
        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-lg);
        }
        
        .legend-section {
            background: var(--section-bg);
            border-radius: 10px;
            padding: var(--spacing-md);
            box-shadow: inset 0 0 10px rgba(0, 255, 136, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .legend-section h3 {
            font-size: 0.75rem;
            color: #00d4ff;
            margin-bottom: var(--spacing-sm);
            text-transform: uppercase;
            letter-spacing: 0.07em;
            border-bottom: 1px solid rgba(0, 212, 255, 0.3);
            padding-bottom: var(--spacing-xs);
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xs);
            font-size: 0.7rem;
            color: var(--text-color-secondary);
        }
        
        .legend-icon {
            font-size: 0.85rem;
            width: 1.2rem;
            text-align: center;
            flex-shrink: 0;
            color: var(--accent-color);
        }

        .legend-item span[style*="background-color"] {
            width: 0.7rem;
            height: 0.7rem;
            border-radius: 50%;
            display: inline-block;
            flex-shrink: 0;
        }
        
        .loading {
            text-align: center;
            padding: var(--spacing-xl);
            font-size: 0.9rem;
            opacity: 0.7;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            color: var(--accent-color);
        }
        
        .spinner {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-color);
            animation: spin 0.8s ease-in-out infinite;
            margin-right: 0;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .news-container {
            max-width: 1500px;
            margin: 0 auto;
            padding: var(--spacing-lg);
        }
        
        .subreddit-section {
            margin-bottom: var(--spacing-xl);
            padding-top: var(--spacing-md);
        }
        
        .subreddit-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--accent-color);
            margin-bottom: var(--spacing-sm);
            text-transform: uppercase;
            letter-spacing: 0.12em;
            border-left: 4px solid var(--accent-color);
            padding-left: var(--spacing-md);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }
        
        .member-count {
            font-size: 0.7rem;
            opacity: 0.8;
            background: var(--accent-color-light);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: 4px;
            color: var(--accent-color);
            font-weight: 500;
        }
        
        .subreddit-description {
            font-size: 0.75rem;
            opacity: 0.9;
            margin-bottom: var(--spacing-lg);
            padding-left: calc(var(--spacing-md) + 4px);
            line-height: 1.6;
            color: var(--text-color-secondary);
        }
        
        .sort-indicator, .api-note {
            text-align: center;
            padding: var(--spacing-md);
            font-size: 0.7rem;
            opacity: 0.6;
            background: rgba(0, 255, 136, 0.08);
            border: 1px solid rgba(0, 255, 136, 0.25);
            border-radius: 8px;
            margin-bottom: var(--spacing-lg);
            line-height: 1.4;
        }
        
        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }
        
        .stock-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            padding: var(--spacing-md);
            transition: all 0.3s ease;
            backdrop-filter: blur(6px);
            position: relative;
            overflow: hidden;
            height: 320px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .stock-card.hot-post {
            border-color: var(--rocket-color);
            box-shadow: 0 0 20px rgba(255, 107, 0, 0.3);
        }

        .stock-card.mega-hot {
            animation: pulse-glow 1s ease-in-out infinite;
        }
        
        .stock-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--accent-color), transparent);
            opacity: 0;
            transition: opacity 0.3s ease, transform 0.3s ease;
            transform: translateY(-3px);
        }

        .stock-card.bearish::before {
            background: linear-gradient(90deg, transparent, var(--bear-color), transparent);
        }
        
        .stock-card:hover {
            transform: translateY(-5px);
            border-color: rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.06);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .stock-card:hover::before {
            opacity: 1;
            transform: translateY(0);
        }
        
        .stock-title {
            font-size: 0.85rem;
            font-weight: 600;
            line-height: 1.3;
            margin-bottom: var(--spacing-sm);
            color: #ffffff;
            text-decoration: none;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            max-height: 3.9rem;
        }
        
        .stock-title:hover {
            color: var(--accent-color);
            text-decoration: underline;
        }
        
        .stock-type {
            background: var(--accent-color-light);
            border: 1px solid var(--accent-color-border);
            border-radius: 5px;
            padding: 0.2rem 0.4rem;
            font-size: 0.55rem;
            color: var(--accent-color);
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            text-align: center;
            text-transform: uppercase;
            align-self: flex-start;
        }

        /* Specific colors for stock-type backgrounds */
        .stock-type.serious { background-color: rgba(0, 255, 136, 0.15); border-color: rgba(0, 255, 136, 0.3); color: var(--accent-color); }
        .stock-type.yolo { background-color: rgba(255, 170, 0, 0.15); border-color: rgba(255, 170, 0, 0.3); color: var(--info-color-orange); }
        .stock-type.trading { background-color: rgba(0, 170, 255, 0.15); border-color: rgba(0, 170, 255, 0.3); color: var(--info-color-blue); }
        .stock-type.penny { background-color: rgba(170, 68, 255, 0.15); border-color: rgba(170, 68, 255, 0.3); color: var(--info-color-purple); }
        .stock-type.value { background-color: rgba(128, 0, 128, 0.15); border-color: rgba(128, 0, 128, 0.3); color: #c080ff; }

        .sentiment-indicator {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            margin-bottom: var(--spacing-sm);
            font-size: 0.6rem;
            opacity: 0.9;
        }

        .sentiment-emoji {
            font-size: 1.1rem;
        }

        .sentiment-text {
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.05em;
        }

        .sentiment-indicator.bullish .sentiment-text {
            color: var(--accent-color);
        }

        .sentiment-indicator.bearish .sentiment-text {
            color: var(--bear-color);
        }

        .sentiment-indicator.neutral .sentiment-text {
            color: #ffaa00;
        }

        .stock-snippet {
            font-size: 0.7rem;
            line-height: 1.4;
            opacity: 0.85;
            margin-bottom: var(--spacing-md);
            color: var(--text-color-secondary);
            flex-grow: 1;
            overflow-y: auto;
            text-align: left;
            max-height: 5rem;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-color) transparent;
        }

        .stock-snippet::-webkit-scrollbar {
            width: 6px;
        }

        .stock-snippet::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .stock-snippet::-webkit-scrollbar-thumb {
            background-color: var(--accent-color);
            border-radius: 10px;
            border: 1px solid var(--card-bg);
        }
        
        .stock-metrics {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: var(--spacing-sm);
            font-size: 0.55rem;
            opacity: 0.95;
            flex-wrap: wrap;
            gap: var(--spacing-xs);
        }
        
        .stock-metric {
            display: flex;
            align-items: center;
            gap: 0.2rem;
            color: var(--text-color-primary);
            min-width: 60px;
            justify-content: center;
        }
        
        .stock-metric-icon {
            font-size: 0.7rem;
            color: var(--accent-color);
        }
        
        .stock-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.5rem;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 0.07em;
            margin-top: auto;
            flex-shrink: 0;
            padding-top: var(--spacing-sm);
            border-top: 1px dashed rgba(255, 255, 255, 0.05);
        }
        
        .stock-source {
            color: var(--accent-color);
            font-weight: 500;
        }

        .timestamp {
            white-space: nowrap;
        }
        
        .error {
            text-align: center;
            padding: var(--spacing-xl);
            color: var(--error-color);
            font-size: 0.9rem;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 8px;
            margin: var(--spacing-lg) auto;
            max-width: 600px;
        }

        .error h3 {
            margin-bottom: var(--spacing-sm);
            font-size: 1.1rem;
        }
        
        .refresh-btn {
            position: fixed;
            bottom: var(--spacing-lg);
            right: var(--spacing-lg);
            background: var(--accent-color-light);
            border: 1px solid var(--accent-color-border);
            color: var(--accent-color);
            padding: var(--spacing-md);
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            backdrop-filter: blur(12px);
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .refresh-btn:hover {
            background: rgba(0, 255, 136, 0.25);
            transform: rotate(360deg) scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 255, 136, 0.3);
        }

        /* Quick filters */
        .filter-bar {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-color-primary);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.7rem;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .filter-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .filter-btn.active {
            background: var(--accent-color);
            color: black;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        /* Tendies counter */
        .tendies-counter {
            position: fixed;
            bottom: 1rem;
            left: 1rem;
            background: rgba(0, 0, 0, 0.8);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            border: 1px solid var(--accent-color);
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tendies-value {
            color: var(--gain-color);
            font-weight: 700;
        }
        
        /* Responsive breakpoints */
        @media (max-width: 1200px) {
            .news-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }
        
        @media (max-width: 900px) {
            .news-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
            .legend-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
        }
        
        @media (max-width: 600px) {
            .header h1 {
                font-size: 2.2rem;
            }
            .header p {
                font-size: 0.7rem;
            }
            .news-container {
                padding: var(--spacing-md);
            }
            .news-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-sm);
            }
            .stock-card {
                height: auto;
                min-height: 300px;
                padding: var(--spacing-sm);
            }
            .stock-metrics {
                flex-direction: row;
                justify-content: space-around;
                align-items: flex-start;
                font-size: 0.6rem;
                gap: var(--spacing-xs);
                margin-bottom: var(--spacing-sm);
            }
            .stock-metric {
                justify-content: center;
                flex: 1;
            }
            .stock-meta {
                font-size: 0.45rem;
                flex-direction: row;
                justify-content: space-between;
                gap: 0.2rem;
                text-align: left;
            }
            .subreddit-title {
                font-size: 1rem;
                flex-direction: column;
                align-items: flex-start;
                gap: 0.3rem;
                padding-left: var(--spacing-sm);
            }
            .subreddit-description {
                font-size: 0.65rem;
                padding-left: var(--spacing-sm);
            }
            .legend {
                padding: var(--spacing-md);
            }
            .legend-section h3 {
                font-size: 0.7rem;
            }
            .legend-item {
                font-size: 0.65rem;
            }
            .refresh-btn {
                padding: 0.6rem;
                font-size: 1rem;
                bottom: var(--spacing-md);
                right: var(--spacing-md);
            }
            .api-note, .sort-indicator {
                font-size: 0.6rem;
                padding: 0.6rem;
            }
            .stock-snippet {
                max-height: 6rem;
            }
            .stats-bar {
                gap: 1rem;
                padding: 0.75rem;
            }
            .meme-toggle {
                top: 0.5rem;
                right: 0.5rem;
                font-size: 0.7rem;
                padding: 0.4rem 0.8rem;
            }
            .tendies-counter {
                font-size: 0.7rem;
                padding: 0.4rem 0.8rem;
            }
        }
        
        /* Touch-friendly improvements */
        @media (hover: none) and (pointer: coarse) {
            .stock-card:hover {
                transform: none;
                border-color: rgba(255, 255, 255, 0.08);
                background: var(--card-bg);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            }
            .stock-card:hover::before {
                opacity: 0;
                transform: translateY(-3px);
            }
            .stock-card:active {
                transform: translateY(-2px);
                background: rgba(255, 255, 255, 0.05);
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            }
             .refresh-btn:hover {
				transform: none;
               background: rgba(0, 255, 136, 0.1);
               box-shadow: 0 4px 15px rgba(0, 255, 136, 0.2);
           }
            .refresh-btn:active {
               transform: scale(0.95);
               background: rgba(0, 255, 136, 0.2);
           }
       }
   </style>
</head>
<body>
   <div class="ticker-wrapper">
       <div class="ticker" id="ticker">
           <!-- Ticker items will be populated dynamically -->
       </div>
   </div>

   <header class="header">
       <h1>📈STONK ALERTS📉 <span class="rocket">🚀</span></h1>
       <div class="subtitle">💎🙌 DIAMOND HANDS ONLY 💎🙌</div>
       <p>Market Sentiment • Stock Discussion • Live Trading • Tendies Tracker</p>
   </header>

   <button class="meme-toggle" onclick="toggleMemeMode()">🎉 MEME MODE</button>
   
   <div class="stats-bar" id="stats-bar">
       <div class="stat-item">
           <span class="stat-label">🔥 Hottest Post:</span>
           <span class="stat-value" id="hottest-score">Loading...</span>
       </div>
       <div class="stat-item">
           <span class="stat-label">🐂 Bull/Bear Ratio:</span>
           <span class="stat-value" id="sentiment-ratio">Loading...</span>
       </div>
       <div class="stat-item">
           <span class="stat-label">💬 Total Comments:</span>
           <span class="stat-value" id="total-comments">Loading...</span>
       </div>
       <div class="stat-item">
           <span class="stat-label">🚀 Rocket Count:</span>
           <span class="stat-value gain" id="rocket-count">Loading...</span>
       </div>
   </div>
   
   <main class="news-container">
       
       <section class="legend">
           <div class="legend-grid">
               <div class="legend-section">
                   <h3>📊 Thread Metrics</h3>
                   <div class="legend-item">
                       <span class="legend-icon" aria-hidden="true">🔥</span>
                       <span>Upvotes (community interest)</span>
                   </div>
                   <div class="legend-item">
                       <span class="legend-icon" aria-hidden="true">💬</span>
                       <span>Comments (discussion activity)</span>
                   </div>
                   <div class="legend-item">
                       <span class="legend-icon" aria-hidden="true">⚡</span>
                       <span>Upvote ratio (post quality)</span>
                   </div>
                   <div class="legend-item">
                       <span class="legend-icon" aria-hidden="true">👤</span>
                       <span>Original poster (OP)</span>
                   </div>
                   <div class="legend-item">
                       <span class="legend-icon" aria-hidden="true">⏰</span>
                       <span>Time posted</span>
                   </div>
               </div>
               
               <div class="legend-section">
                   <h3>📈 Sentiment Analysis</h3>
                   <div class="legend-item">
                       <span style="background-color: var(--accent-color);" aria-hidden="true"></span>
                       <span>🐂 Bullish (buy, calls, moon, rocket)</span>
                   </div>
                   <div class="legend-item">
                       <span style="background-color: var(--bear-color);" aria-hidden="true"></span>
                       <span>🐻 Bearish (sell, puts, crash, short)</span>
                   </div>
                   <div class="legend-item">
                       <span style="background-color: #ffaa00;" aria-hidden="true"></span>
                       <span>🦘 Neutral (mixed/unclear sentiment)</span>
                   </div>
               </div>
               
               <div class="legend-section">
                   <h3>🎯 Community Types</h3>
                   <div class="legend-item">
                       <span style="background-color: var(--accent-color);" aria-hidden="true"></span>
                       <span>r/stocks (serious analysis)</span>
                   </div>
                   <div class="legend-item">
                       <span style="background-color: var(--info-color-orange);" aria-hidden="true"></span>
                       <span>r/wallstreetbets (YOLO trades)</span>
                   </div>
                   <div class="legend-item">
                       <span style="background-color: var(--info-color-blue);" aria-hidden="true"></span>
                       <span>r/StockMarket (active trading)</span>
                   </div>
                   <div class="legend-item">
                       <span style="background-color: var(--info-color-purple);" aria-hidden="true"></span>
                       <span>r/pennystocks & r/UndervaluedStonks</span>
                   </div>
               </div>

               <div class="legend-section">
                   <h3>🏷️ WSB Special Tags</h3>
                   <div class="legend-item">
                       <span style="background-color: var(--dd-color);" aria-hidden="true"></span>
                       <span>DD - Due Diligence (research)</span>
                   </div>
                   <div class="legend-item">
                       <span style="background-color: var(--rocket-color);" aria-hidden="true"></span>
                       <span>YOLO - You Only Live Once</span>
                   </div>
                   <div class="legend-item">
                       <span style="background-color: var(--gain-color);" aria-hidden="true"></span>
                       <span>Gain Porn (profit screenshots)</span>
                   </div>
                   <div class="legend-item">
                       <span style="background-color: var(--loss-color);" aria-hidden="true"></span>
                       <span>Loss Porn (loss screenshots)</span>
                   </div>
                   <div class="legend-item">
                       <span style="background-color: var(--meme-color);" aria-hidden="true"></span>
                       <span>Meme Stock Alert</span>
                   </div>
               </div>
           </div>
       </section>
       
       <div class="sort-indicator" role="status" aria-live="polite">
           📈 Subreddits organized by degeneracy level, posts sorted by rocket fuel ⛽
       </div>

       <div class="filter-bar">
           <button class="filter-btn active" onclick="filterPosts('all')">🌟 All Posts</button>
           <button class="filter-btn" onclick="filterPosts('bullish')">🐂 Bullish Only</button>
           <button class="filter-btn" onclick="filterPosts('bearish')">🐻 Bearish Only</button>
           <button class="filter-btn" onclick="filterPosts('hot')">🔥 Super Hot</button>
           <button class="filter-btn" onclick="filterPosts('dd')">📊 DD Posts</button>
           <button class="filter-btn" onclick="filterPosts('yolo')">🚀 YOLO Trades</button>
       </div>
       
       <div class="loading" id="loading" role="status" aria-live="assertive" aria-atomic="true">
           <div class="spinner"></div>
           Loading tendies... 🍗
       </div>
       <div id="news-content" style="display: none;"></div>
       <div id="error-content" style="display: none;"></div>
   </main>
   
   <button class="refresh-btn" onclick="loadPosts()" title="Refresh Discussions" aria-label="Refresh Stock Discussions">
       🚀
   </button>

   <div class="tendies-counter">
       <span>🍗 Tendies:</span>
       <span class="tendies-value" id="tendies-count">0</span>
   </div>

   <script>
       // Stock subreddits ordered by WSB culture prominence
       const STOCK_SUBREDDITS = [
           {
               name: 'wallstreetbets',
               members: '15M+',
               description: 'The casino of the stock market. Home of diamond hands, wife\'s boyfriends, and legendary loss porn. This is where tendies are made and lost.',
               type: 'yolo'
           },
           {
               name: 'stocks',
               members: '7M+', 
               description: 'For those who actually read financial statements. Serious DD and boomer stocks welcome here.',
               type: 'serious'
           },
           {
               name: 'StockMarket',
               members: '2M+',
               description: 'The middle ground between YOLO and boring. Day traders and swing traders unite!',
               type: 'trading'
           },
           {
               name: 'pennystocks',
               members: '2M+',
               description: 'Where dreams of lambos are born from $0.0001 stocks. High risk, high reward, mostly risk.',
               type: 'penny'
           },
           {
               name: 'UndervaluedStonks',
               members: '150k+',
               description: 'Value investing for those who think Warren Buffett is too aggressive.',
               type: 'value'
           }
       ];

       // Enhanced sentiment analysis keywords
       const SENTIMENT_KEYWORDS = {
           bullish: ['moon', 'rocket', 'bull', 'bullish', 'buy', 'calls', 'long', 'up', 'green', 'gains', 'pump', 'squeeze', 'rally', 'breakout', 'diamond hands', 'hodl', 'to the moon', 'stonks', 'tendies', 'yolo', 'lambo', 'printer', 'brrrr', 'ath', 'all time high', 'gap up', 'breakout', 'support', 'oversold', 'undervalued', 'accumulation', 'catalyst', 'gamma squeeze', 'short squeeze', 'apes together strong', 'buy the dip', 'btfd', 'leaps', 'itm', 'we like the stock'],
           bearish: ['crash', 'bear', 'bearish', 'put', 'puts', 'short', 'down', 'red', 'dump', 'sell', 'drop', 'tank', 'collapse', 'bubble', 'correction', 'recession', 'rug pull', 'drill', 'capitulation', 'gap down', 'resistance', 'overbought', 'overvalued', 'dead cat', 'falling knife', 'bag holder', 'guh', 'loss porn', 'margin call', 'theta gang', 'iv crush', 'worthless', 'expire', 'bankruptcy', 'delisted', 'halt', 'circuit breaker']
       };

       // WSB specific tags
       const WSB_TAGS = {
           dd: ['dd', 'due diligence', 'research', 'analysis', 'fundamentals', 'technicals', 'sec filing'],
           yolo: ['yolo', 'all in', 'life savings', 'student loans', 'mortgage', 'credit card', 'margin'],
           gain: ['gain', 'gains', 'profit', 'tendies', 'print', 'printing', 'win', 'winner', 'green'],
           loss: ['loss', 'lost', 'gone', 'guh', 'rip', 'expired', 'worthless', '-99%', 'bankruptcy'],
           meme: ['gme', 'amc', 'bb', 'nok', 'pltr', 'tsla', 'spce', 'meme stock', 'ape', 'diamond hands']
       };

       // Ticker patterns for the scrolling banner
       const TICKER_PATTERNS = [
           "GME 🚀🚀🚀", "AMC TO THE MOON 🌙", "DIAMOND HANDS 💎🙌", "BEARS R FUK 🐻❌", 
           "STONKS ONLY GO UP 📈", "BUY HIGH SELL LOW 📉", "WIFE'S BOYFRIEND APPROVED ✅",
           "TENDIES INCOMING 🍗", "YOLO OR BUST 🎰", "HODL THE LINE 💪", "APE TOGETHER STRONG 🦍",
           "PRINTER GO BRRR 💵", "GUH MOMENT 😱", "THETA GANG 🏴‍☠️", "IV CRUSH INCOMING ⚡",
           "MARGIN CALL 📞", "WENDY'S DUMPSTER 🍔", "BEHIND THE CASINO 🎲"
       ];

       let allPosts = [];
       let currentFilter = 'all';
       let tendiesCount = 0;
       let memeMode = false;

       // Function to detect special post types
       function detectPostType(text) {
           const lowerText = text.toLowerCase();
           const types = [];
           
           for (const [type, keywords] of Object.entries(WSB_TAGS)) {
               if (keywords.some(keyword => lowerText.includes(keyword))) {
                   types.push(type);
               }
           }
           
           return types;
       }

       // Function to analyze sentiment
       function analyzeSentiment(text) {
           const lowerText = text.toLowerCase();
           
           let bullishCount = 0;
           let bearishCount = 0;
           
           SENTIMENT_KEYWORDS.bullish.forEach(word => {
               const regex = new RegExp(`\\b${word}\\b`, 'g');
               const matches = lowerText.match(regex);
               if (matches) bullishCount += matches.length;
           });
           
           SENTIMENT_KEYWORDS.bearish.forEach(word => {
               const regex = new RegExp(`\\b${word}\\b`, 'g');
               const matches = lowerText.match(regex);
               if (matches) bearishCount += matches.length;
           });
           
           // Count rocket emojis as extra bullish
           const rocketCount = (text.match(/🚀/g) || []).length;
           bullishCount += rocketCount * 3;
           
           if (bullishCount > bearishCount) {
               return { sentiment: 'bullish', emoji: '🐂', text: 'Bullish' };
           } else if (bearishCount > bullishCount) {
               return { sentiment: 'bearish', emoji: '🐻', text: 'Bearish' };
           } else {
               return { sentiment: 'neutral', emoji: '🦘', text: 'Neutral' };
           }
       }

       // Initialize ticker
       function initTicker() {
           const ticker = document.getElementById('ticker');
           let tickerHtml = '';
           
           // Duplicate for seamless loop
           for (let i = 0; i < 2; i++) {
               TICKER_PATTERNS.forEach(pattern => {
                   const isGain = pattern.includes('🚀') || pattern.includes('MOON') || pattern.includes('UP');
                   const className = isGain ? 'gain' : (pattern.includes('📉') || pattern.includes('FUK') ? 'loss' : '');
                   tickerHtml += `<span class="ticker-item ${className}">${pattern}</span>`;
               });
           }
           
           ticker.innerHTML = tickerHtml;
       }

       // Function to fetch posts from a single subreddit
       async function fetchSubreddit(subreddit, limit = 12) {
           try {
               const response = await fetch(`https://www.reddit.com/r/${subreddit}/hot.json?limit=${limit}`);
               
               if (!response.ok) {
                   throw new Error(`HTTP error! status: ${response.status}`);
               }
               
               const data = await response.json();
               
               return data.data.children.map(post => {
                   const postData = post.data;
                   const fullText = `${postData.title} ${postData.selftext || ''}`;
                   const sentimentData = analyzeSentiment(fullText);
                   const postTypes = detectPostType(fullText);
                   
                   return {
                       title: postData.title,
                       url: postData.url.startsWith('/') ? `https://reddit.com${postData.url}` : postData.url,
                       redditUrl: `https://reddit.com${postData.permalink}`,
                       source: `r/${subreddit}`,
                       publishedAt: new Date(postData.created_utc * 1000).toISOString(),
                       description: postData.selftext || postData.title,
                       score: postData.score,
                       comments: postData.num_comments,
                       ratio: Math.round(postData.upvote_ratio * 100),
                       author: postData.author,
                       subreddit: subreddit,
                       sentiment: sentimentData,
                       postTypes: postTypes,
                       rocketCount: (fullText.match(/🚀/g) || []).length
                   };
               });
           } catch (error) {
               console.error(`Error fetching r/${subreddit}:`, error);
               return [];
           }
       }

       // Function to fetch posts from all defined stock subreddits
       async function fetchAllStockSubreddits() {
           const subredditData = {};
           
           for (const subreddit of STOCK_SUBREDDITS) {
               console.log(`Fetching r/${subreddit.name}...`);
               const posts = await fetchSubreddit(subreddit.name, 12);
               
               // Sort by engagement score
               const sortedPosts = posts.sort((a, b) => {
                   const engagementA = a.score + (a.comments * 10) + (a.rocketCount * 100);
                   const engagementB = b.score + (b.comments * 10) + (b.rocketCount * 100);
                   return engagementB - engagementA;
               });
               
               subredditData[subreddit.name] = {
                   info: subreddit,
                   posts: sortedPosts.slice(0, 10)
               };
           }
           
           return subredditData;
       }

       // Function to update stats
       function updateStats(posts) {
           let hottestScore = 0;
           let bullishCount = 0;
           let bearishCount = 0;
           let totalComments = 0;
           let totalRockets = 0;

           posts.forEach(post => {
               if (post.score > hottestScore) {
                   hottestScore = post.score;
               }
               if (post.sentiment.sentiment === 'bullish') bullishCount++;
               if (post.sentiment.sentiment === 'bearish') bearishCount++;
               totalComments += post.comments;
               totalRockets += post.rocketCount;
           });

           document.getElementById('hottest-score').textContent = formatNumber(hottestScore) + ' 🔥';
           
           const ratio = bearishCount > 0 ? (bullishCount / bearishCount).toFixed(1) : bullishCount;
           document.getElementById('sentiment-ratio').textContent = ratio + ':1';
           document.getElementById('sentiment-ratio').className = ratio > 1 ? 'stat-value gain' : 'stat-value loss';
           
           document.getElementById('total-comments').textContent = formatNumber(totalComments);
           document.getElementById('rocket-count').textContent = totalRockets;

           // Update tendies based on bullish sentiment
           tendiesCount += bullishCount * 10;
           document.getElementById('tendies-count').textContent = formatNumber(tendiesCount);
       }
       
       // Function to truncate text to a word limit
       function truncateText(text, wordLimit) {
           if (!text) return '';
           const words = text.split(/\s+/);
           if (words.length <= wordLimit) return text;
           return words.slice(0, wordLimit).join(' ') + '...';
       }
       
       // Function to format time difference
       function getTimeAgo(dateString) {
           const now = new Date();
           const published = new Date(dateString);
           const diffInSeconds = Math.floor((now - published) / 1000);
           
           if (diffInSeconds < 60) return `${diffInSeconds}s`;
           const diffInMinutes = Math.floor(diffInSeconds / 60);
           if (diffInMinutes < 60) return `${diffInMinutes}m`;
           const diffInHours = Math.floor(diffInMinutes / 60);
           if (diffInHours < 24) return `${diffInHours}h`;
           const diffInDays = Math.floor(diffInHours / 24);
           if (diffInDays < 30) return `${diffInDays}d`;
           const diffInMonths = Math.floor(diffInDays / 30);
           if (diffInMonths < 12) return `${diffInMonths}mo`;
           return `${Math.floor(diffInMonths / 12)}y`;
       }

       // Function to format large numbers
       function formatNumber(num) {
           if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
           if (num >= 1000) return (num / 1000).toFixed(1) + 'k';
           return num.toString();
       }
      
       // Function to create HTML for a single stock card
       function createStockCard(post, subredditType) {
           const timeAgo = getTimeAgo(post.publishedAt);
           const snippet = truncateText(post.description, 40);
           
           // Determine special classes
           let cardClasses = ['stock-card', post.sentiment.sentiment];
           if (post.score > 5000) cardClasses.push('hot-post');
           if (post.score > 10000) cardClasses.push('mega-hot');
           
           // Create special tags
           let specialTags = '';
           if (post.postTypes.includes('dd')) specialTags += '<span class="wsb-tag dd">DD</span>';
           if (post.postTypes.includes('yolo')) specialTags += '<span class="wsb-tag yolo">YOLO</span>';
           if (post.postTypes.includes('gain')) specialTags += '<span class="wsb-tag gain-porn">GAIN PORN</span>';
           if (post.postTypes.includes('loss')) specialTags += '<span class="wsb-tag loss-porn">LOSS PORN</span>';
           if (post.postTypes.includes('meme')) specialTags += '<span class="wsb-tag meme">MEME STOCK</span>';
           
           // Add rockets if super hot
           const rocketDisplay = post.rocketCount > 0 ? '🚀'.repeat(Math.min(post.rocketCount, 5)) : '';
           
           return `
               <div class="${cardClasses.join(' ')}" tabindex="0" role="article" 
                   aria-labelledby="post-title-${post.subreddit}-${post.score}" 
                   aria-describedby="post-snippet-${post.subreddit}-${post.score}"
                   data-sentiment="${post.sentiment.sentiment}"
                   data-score="${post.score}"
                   data-types="${post.postTypes.join(',')}">
                   <a href="${post.redditUrl}" target="_blank" rel="noopener noreferrer" 
                       class="stock-title" id="post-title-${post.subreddit}-${post.score}">
                       ${post.title} ${rocketDisplay}
                   </a>
                   
                   <div class="stock-type ${subredditType}">R/${post.subreddit.toUpperCase()}</div>
                   ${specialTags}
                   
                   <div class="sentiment-indicator ${post.sentiment.sentiment}">
                       <span class="sentiment-emoji" aria-hidden="true">${post.sentiment.emoji}</span>
                       <span class="sentiment-text">${post.sentiment.text}</span>
                   </div>
                   
                   <p class="stock-snippet" id="post-snippet-${post.subreddit}-${post.score}">
                       ${snippet}
                   </p>
                   
                   <div class="stock-metrics">
                       <div class="stock-metric" title="${post.score} Upvotes">
                           <span class="stock-metric-icon" aria-hidden="true">🔥</span>
                           <span>${formatNumber(post.score)}</span>
                       </div>
                       <div class="stock-metric" title="${post.comments} Comments">
                           <span class="stock-metric-icon" aria-hidden="true">💬</span>
                           <span>${formatNumber(post.comments)}</span>
                       </div>
                       <div class="stock-metric" title="${post.ratio}% Upvote Ratio">
                           <span class="stock-metric-icon" aria-hidden="true">⚡</span>
                           <span>${post.ratio}%</span>
                       </div>
                       <div class="stock-metric" title="Posted by u/${post.author}">
                           <span class="stock-metric-icon" aria-hidden="true">👤</span>
                           <span>u/${truncateText(post.author, 1)}</span>
                       </div>
                   </div>
                   
                   <div class="stock-meta">
                       <span class="stock-source" aria-label="Source subreddit">R/${post.subreddit.toUpperCase()}</span>
                       <time class="timestamp" datetime="${post.publishedAt}" aria-label="Time posted">${timeAgo} ago</time>
                   </div>
               </div>
           `;
       }
      
       // Function to display fetched posts in the UI
       function displayPosts(subredditData) {
           const container = document.getElementById('news-content');
           let html = '';
           allPosts = [];
           
           // Loop through subreddits in the predefined order
           for (const subredditInfo of STOCK_SUBREDDITS) {
               const data = subredditData[subredditInfo.name];
               if (data && data.posts.length > 0) {
                   allPosts = allPosts.concat(data.posts);
                   
                   html += `
                       <section class="subreddit-section">
                           <h2 class="subreddit-title">
                               r/${data.info.name}
                               <span class="member-count">${data.info.members} degenerates</span>
                           </h2>
                           <p class="subreddit-description">${data.info.description}</p>
                           <div class="news-grid">
                               ${data.posts.map(post => createStockCard(post, data.info.type)).join('')}
                           </div>
                       </section>
                   `;
               }
           }
           
           container.innerHTML = html;
           updateStats(allPosts);
           applyFilter(currentFilter);
       }

       // Filter functions
       function filterPosts(filter) {
           currentFilter = filter;
           
           // Update active button
           document.querySelectorAll('.filter-btn').forEach(btn => {
               btn.classList.remove('active');
           });
           event.target.classList.add('active');
           
           applyFilter(filter);
       }

       function applyFilter(filter) {
           const cards = document.querySelectorAll('.stock-card');
           
           cards.forEach(card => {
               let show = true;
               
               switch(filter) {
                   case 'bullish':
                       show = card.dataset.sentiment === 'bullish';
                       break;
                   case 'bearish':
                       show = card.dataset.sentiment === 'bearish';
                       break;
                   case 'hot':
                       show = parseInt(card.dataset.score) > 5000;
                       break;
                   case 'dd':
                       show = card.dataset.types.includes('dd');
                       break;
                   case 'yolo':
                       show = card.dataset.types.includes('yolo');
                       break;
               }
               
               card.style.display = show ? 'flex' : 'none';
           });
       }

       // Meme mode
       function toggleMemeMode() {
           memeMode = !memeMode;
           document.body.classList.toggle('meme-mode');
           
           if (memeMode) {
               startEmojiRain();
               document.querySelector('.meme-toggle').textContent = '🎉 NORMAL MODE';
           } else {
               document.querySelector('.meme-toggle').textContent = '🎉 MEME MODE';
           }
       }

       function startEmojiRain() {
           if (!memeMode) return;
           
           const emojis = ['🚀', '💎', '🙌', '🐂', '🐻', '🍗', '📈', '📉', '💰', '🎰'];
           const emoji = emojis[Math.floor(Math.random() * emojis.length)];
           
           const span = document.createElement('span');
           span.className = 'emoji-rain';
           span.textContent = emoji;
           span.style.left = Math.random() * window.innerWidth + 'px';
           span.style.animationDuration = (Math.random() * 2 + 2) + 's';
           
           document.body.appendChild(span);
           
           setTimeout(() => span.remove(), 4000);
           
           if (memeMode) {
               setTimeout(startEmojiRain, 200);
           }
       }
      
       // Function to show error message
       function showError(message) {
           const errorContainer = document.getElementById('error-content');
           errorContainer.innerHTML = `
               <div class="error" role="alert" aria-live="assertive">
                   <h3>💎🙌 HODL! Unable to load tendies</h3>
                   <p>${message || 'The market is being manipulated. Try again later.'}</p>
                   <p>This is not financial advice. We just like the stock.</p>
               </div>
           `;
           errorContainer.style.display = 'block';
       }
      
       // Main function to load and display posts
       async function loadPosts() {
           const loading = document.getElementById('loading');
           const content = document.getElementById('news-content');
           const errorContent = document.getElementById('error-content');
           
           // Show loading, hide content and errors
           loading.style.display = 'flex';
           content.style.display = 'none';
           errorContent.style.display = 'none';
           
           try {
               console.log('Fetching tendies from Reddit...');
               
               const subredditData = await fetchAllStockSubreddits();
               
               console.log('Tendies acquired! 🍗');
               
               displayPosts(subredditData);
               
               // Hide loading, show content
               loading.style.display = 'none';
               content.style.display = 'block';
               
           } catch (error) {
                console.error('GUH! Error loading posts:', error);
                loading.style.display = 'none';
                showError(error.message);
            }
        }
      
       // Load posts when the DOM is fully loaded
       document.addEventListener('DOMContentLoaded', () => {
           initTicker();
           loadPosts();
           
           // Auto-refresh every 5 minutes
           setInterval(loadPosts, 300000);
           
           // Increment tendies slowly
           setInterval(() => {
               tendiesCount += Math.floor(Math.random() * 10);
               document.getElementById('tendies-count').textContent = formatNumber(tendiesCount);
           }, 3000);
       });

       // Keyboard shortcuts
       document.addEventListener('keydown', (e) => {
           if (e.key === 'r' || e.key === 'R') {
               loadPosts();
           } else if (e.key === 'm' || e.key === 'M') {
               toggleMemeMode();
           }
       });
   </script>
</body>
</html>
				